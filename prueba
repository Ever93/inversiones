import sqlite3
import tkinter as tk
import db
import datetime
import tkinter.messagebox
from export_excel import exportar_excel

# ... (el resto de tu código) ...

class InversionApp:
    # ... (otras funciones y métodos) ...

    def calcular_balance(self):
        conn, c = db.conectar()
        c.execute("SELECT monto FROM ingreso")
        ingresos = c.fetchall()
        conn.close()
        total_ingresos = sum(ingreso[0] for ingreso in ingresos)

        conn, c = db.conectar()
        c.execute("SELECT monto FROM egreso")
        egresos = c.fetchall()
        conn.close()
        total_egresos = sum(egreso[0] for egreso in egresos)

        # Calcular el balance restando los egresos de los ingresos
        balance = total_ingresos - total_egresos

        formatted_balance = format_number_with_commas(balance)
        self.LabelBalance.config(text=formatted_balance)

    def calcular_suma_egresos(self):
        conn, c = db.conectar()
        c.execute("SELECT monto FROM egreso")
        montos = c.fetchall()
        conn.close()
        total_egresos = sum(monto[0] for monto in montos)
        formatted_total_egresos = format_number_with_commas(total_egresos)
        self.LabelEgreso.config(text=formatted_total_egresos)

        # Después de calcular los egresos, calcular el balance
        self.calcular_balance()

    def calcular_suma_ingresos(self):
        conn, c = db.conectar()
        c.execute("SELECT monto FROM ingreso")
        montos = c.fetchall()
        conn.close()
        total_ingresos = sum(monto[0] for monto in montos)
        formatted_total_ingresos = format_number_with_commas(total_ingresos)
        self.LabelIngreso.config(text=formatted_total_ingresos)

        # Después de calcular los ingresos, calcular el balance
        self.calcular_balance()

# ... (el resto de tu código) ...
